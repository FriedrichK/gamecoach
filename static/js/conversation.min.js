var conversationApp=angular.module("conversationApp",["gamecoachShared","gamecoachNavigation"]),conversationApp=angular.module("conversationApp");conversationApp.controller("SubmissionController",function(a,b,c){b.submit=function(){var b=$("input[type=hidden][name=conversationPartner]").val(),d=angular.element("textarea[name=field]").val();d&&""!==d&&c.postMessage(b,d,function(b){200===b.status&&(angular.element("textarea[name=field]").val(""),a.$broadcast("newMessageSuccessfullySent"))})}}),conversationApp.controller("OtherUserProfileController",function(a,b,c,d,e,f,g,h){var i=$("input[type=hidden][name=conversationPartner]").val();BaseProfileController.call(this,a,b,c,d,e,f,g,h,i)}),conversationApp.controller("MessageController",function(a,b,c,d){var e="123",f=$("input[type=hidden][name=conversationPartner]").val(),g=function(){c.getConversation(e,f,function(b){a.messageStream=d.format(b)})};angular.element(b).ready(function(){g()}),a.$on("newMessageSuccessfullySent",function(){g()})});var conversationApp=angular.module("conversationApp");conversationApp.factory("conversationService",function(a){return{getConversation:function(b,c,d){return a({url:"/api/conversation/"+c,method:"GET",params:{ident:b}}).then(function(a){d(a.data)})}}}),conversationApp.factory("messageService",function(a){return{postMessage:function(b,c,d){return a({url:"/api/conversation/message/",method:"POST",data:{recipient:b,message:c}}).then(function(a){d(a)})}}}),conversationApp.factory("messageStreamFormattingService",function(a){var b=function(a){var b=new Date;return a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()+1&&a.getDate()===b.getDate()?(console.log("match"),!0):!1},c=function(a){return new Date(a.year,a.month,a.day,a.hour,a.minute,a.second,0)},d=function(d){var e=c(d.sent_at),f="shortDate";return b(e)&&(f="shortTime"),d.sent_at=a("date")(e,f),d},e=function(a){var b=[];return angular.forEach(a,function(a){b.push(d(a))}),b};return{format:function(a){return e(a)}}});