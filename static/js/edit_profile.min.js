var editProfileApp=angular.module("editProfileApp",["angularFileUpload","lr.upload","gamecoachShared","gamecoachNavigation"]).config(["$locationProvider",function(a){a.html5Mode(!0)}]),editProfileApp=angular.module("editProfileApp");editProfileApp.controller("EditProfileController",function(a,b,c,d,e,f){var g=function(){var a=new Date;return"/data/mentor/"+h+"/profilePicture?cache="+a.getMilliseconds()},h=angular.element("input[type=hidden][name=system_username]").val();a.profilePictureUri=g();var i=function(a){var c=$.extend({},a);return c.about=e.decodeHtml(a.about),c.statistics.winRate=b("percentAsString")(c.statistics.winRate,1),c};a.profile=i(prefilledValues),a.save=function(b){var d=b.$valid;if(d){try{calq.user.profile(a.profile)}catch(e){}c.submit(a.profile)}},a.uploadFile=function(b){f.hide();var c=d.upload(a,b);c.then(function(){a.profilePictureUri=g()},function(a){f.notifyError(a)})}}),editProfileApp.controller("ProfilePictureController",function(a,b,c){a.onFileSelect=function(a){angular.forEach(a,function(a){c.upload(a)})}});var editProfileApp=angular.module("editProfileApp");editProfileApp.factory("profileService",function(a,b){return{submit:function(c){return a({url:"/api/mentors/",method:"POST",data:c}).then(function(a){200!==a.status&&b.notifyError("There has been an error submitting your profile"),window.location="/profile/"})}}}),editProfileApp.factory("profilePictureUploadService",function(a,b,c){return{upload:function(a){b.upload({url:"/api/mentor/profilePicture/",file:a}).progress(function(){}).success(function(){try{calq.action.track("Uploaded profile picture",{})}catch(a){}}).error(function(){try{calq.action.track("Error uploading profile picture",{})}catch(a){}c.notifyError("There has been an error submitting your profile picture")})}}});